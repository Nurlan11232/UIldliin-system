<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–•—É—É–¥–∞—Å —Å–æ–ª–∏–ª—Ç—ã–Ω –∞–ª–≥–æ—Ä–∏—Ç–º —Å–∏–º—É–ª—è—Ç–æ—Ä</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .control-panel {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .input-row {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-group label {
            font-weight: 600;
            color: #333;
            white-space: nowrap;
        }

        input[type="text"] {
            padding: 10px 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            width: 400px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        input[type="number"] {
            padding: 10px 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            width: 80px;
            transition: border-color 0.3s;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            padding: 10px 24px;
            font-size: 15px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .results {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .algo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid;
        }

        .card.fifo .algo-header {
            border-color: #2196f3;
        }

        .card.lru .algo-header {
            border-color: #9c27b0;
        }

        .card.optimal .algo-header {
            border-color: #4caf50;
        }

        .algo-title {
            font-size: 1.5em;
            font-weight: 700;
        }

        .card.fifo .algo-title {
            color: #2196f3;
        }

        .card.lru .algo-title {
            color: #9c27b0;
        }

        .card.optimal .algo-title {
            color: #4caf50;
        }

        .stats {
            display: flex;
            gap: 20px;
        }

        .stat-item {
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
        }

        .stat-faults {
            background: #ffebee;
            color: #c62828;
        }

        .stat-hits {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .stat-ratio {
            background: #e3f2fd;
            color: #1565c0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            overflow-x: auto;
            display: block;
        }

        thead, tbody {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 8px;
            text-align: center;
            border: 1px solid #5a67d8;
            font-weight: 600;
            white-space: nowrap;
            font-size: 12px;
        }

        td {
            padding: 10px 8px;
            text-align: center;
            border: 1px solid #e0e0e0;
            font-weight: 500;
        }

        .frame-label {
            background: #f5f5f5;
            font-weight: 700;
            color: #333;
        }

        .frame-cell {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .fault-row td {
            font-weight: 700;
        }

        .fault-cell {
            background: #ffcdd2;
            color: #c62828;
        }

        .hit-cell {
            background: #c8e6c9;
            color: #2e7d32;
        }

        tr:hover td {
            background-color: #f0f0f0;
        }

        .fault-row:hover td {
            background-color: inherit;
        }

        .note {
            margin-top: 15px;
            padding: 12px;
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 4px;
            color: #856404;
            font-size: 13px;
        }

        @media (max-width: 768px) {
            .input-row {
                flex-direction: column;
                align-items: flex-start;
            }

            input[type="text"] {
                width: 100%;
            }

            .stats {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üñ•Ô∏è –•—É—É–¥–∞—Å —Å–æ–ª–∏–ª—Ç—ã–Ω –∞–ª–≥–æ—Ä–∏—Ç–º —Å–∏–º—É–ª—è—Ç–æ—Ä</h1>
            <p>Page Replacement Algorithm Simulator - FIFO / LRU / Optimal</p>
        </div>

        <div class="control-panel">
            <div class="input-row">
                <div class="input-group">
                    <label>Reference String:</label>
                    <input type="text" id="refInput" value="3,1,2,3,4,2,3,0,4,0,3,1,2">
                </div>
                <div class="input-group">
                    <label>–§—Ä—ç–π–º —Ç–æ–æ:</label>
                    <input type="number" id="framesInput" min="1" max="10" value="3">
                </div>
                <button class="btn-primary" id="runBtn">‚ñ∂ –°–∏–º—É–ª—è—Ü–∏ –∞–∂–∏–ª–ª—É—É–ª–∞—Ö</button>
                <button class="btn-secondary" id="resetBtn">‚Üª Reset</button>
            </div>
        </div>

        <div class="results">
            <div id="fifoCard" class="card fifo"></div>
            <div id="lruCard" class="card lru"></div>
            <div id="optCard" class="card optimal"></div>
        </div>
    </div>

    <script>
        function parseRef(s) {
            return s.split(/[,\s]+/).map(x => x.trim()).filter(x => x !== "").map(Number);
        }

        function simulateFIFO(ref, framesCount) {
            const frames = [];
            const steps = [];
            let queue = [];
            let faults = 0;
            let hits = 0;

            for (let i = 0; i < ref.length; i++) {
                const p = ref[i];
                const hit = frames.includes(p);
                
                if (!hit) {
                    faults++;
                    if (frames.length < framesCount) {
                        frames.push(p);
                        queue.push(p);
                    } else {
                        const victim = queue.shift();
                        const idx = frames.indexOf(victim);
                        frames[idx] = p;
                        queue.push(p);
                    }
                } else {
                    hits++;
                }
                
                steps.push({ ref: p, frames: frames.slice(), fault: !hit });
            }
            
            return { steps, faults, hits };
        }

        function simulateLRU(ref, framesCount) {
            const frames = [];
            const lastUsed = new Map();
            const steps = [];
            let faults = 0;
            let hits = 0;

            for (let i = 0; i < ref.length; i++) {
                const p = ref[i];
                const hit = frames.includes(p);
                
                if (hit) {
                    hits++;
                    lastUsed.set(p, i);
                } else {
                    faults++;
                    if (frames.length < framesCount) {
                        frames.push(p);
                        lastUsed.set(p, i);
                    } else {
                        let lruPage = null;
                        let lruTime = Infinity;
                        
                        for (const f of frames) {
                            const t = lastUsed.has(f) ? lastUsed.get(f) : -Infinity;
                            if (t < lruTime) {
                                lruTime = t;
                                lruPage = f;
                            }
                        }
                        
                        const idx = frames.indexOf(lruPage);
                        frames[idx] = p;
                        lastUsed.delete(lruPage);
                        lastUsed.set(p, i);
                    }
                }
                
                steps.push({ ref: p, frames: frames.slice(), fault: !hit });
            }
            
            return { steps, faults, hits };
        }

        function simulateOptimal(ref, framesCount) {
            const frames = [];
            const steps = [];
            let faults = 0;
            let hits = 0;

            for (let i = 0; i < ref.length; i++) {
                const p = ref[i];
                const hit = frames.includes(p);
                
                if (!hit) {
                    faults++;
                    if (frames.length < framesCount) {
                        frames.push(p);
                    } else {
                        let victim = null;
                        let farthest = -1;
                        
                        for (const f of frames) {
                            let nextIndex = ref.slice(i + 1).indexOf(f);
                            if (nextIndex === -1) nextIndex = Infinity;
                            if (nextIndex > farthest) {
                                farthest = nextIndex;
                                victim = f;
                            }
                        }
                        
                        const idx = frames.indexOf(victim);
                        frames[idx] = p;
                    }
                } else {
                    hits++;
                }
                
                steps.push({ ref: p, frames: frames.slice(), fault: !hit });
            }
            
            return { steps, faults, hits };
        }

        function renderTable(container, title, result) {
            const { steps, faults, hits } = result;
            const total = steps.length;
            const hitRatio = ((hits / total) * 100).toFixed(1);
            
            container.innerHTML = '';
            
            const header = document.createElement('div');
            header.className = 'algo-header';
            header.innerHTML = `
                <div class="algo-title">${title}</div>
                <div class="stats">
                    <div class="stat-item stat-faults">–ê–ª–¥–∞–≥–¥–∞–ª: ${faults}</div>
                    <div class="stat-item stat-hits">–•–∏—Ç: ${hits}</div>
                    <div class="stat-item stat-ratio">–•—É–≤—å: ${hitRatio}%</div>
                </div>
            `;
            container.appendChild(header);

            const table = document.createElement('table');
            const thead = document.createElement('thead');
            const hrow = document.createElement('tr');
            
            const emptyTh = document.createElement('th');
            emptyTh.textContent = 'Frame';
            hrow.appendChild(emptyTh);
            
            for (let i = 0; i < steps.length; i++) {
                const th = document.createElement('th');
                th.innerHTML = `${i + 1}<br>${steps[i].ref}`;
                hrow.appendChild(th);
            }
            
            thead.appendChild(hrow);
            table.appendChild(thead);

            const tbody = document.createElement('tbody');
            const framesCount = Math.max(...steps.map(s => s.frames.length));
            
            for (let r = 0; r < framesCount; r++) {
                const tr = document.createElement('tr');
                const label = document.createElement('td');
                label.className = 'frame-label';
                label.textContent = `–§—Ä—ç–π–º ${r + 1}`;
                tr.appendChild(label);
                
                for (let i = 0; i < steps.length; i++) {
                    const td = document.createElement('td');
                    td.className = 'frame-cell';
                    const val = steps[i].frames[r];
                    td.textContent = (val === undefined ? '' : val);
                    tr.appendChild(td);
                }
                
                tbody.appendChild(tr);
            }

            const faultRow = document.createElement('tr');
            faultRow.className = 'fault-row';
            const faultLabel = document.createElement('td');
            faultLabel.className = 'frame-label';
            faultLabel.textContent = '–¢”©–ª”©–≤';
            faultRow.appendChild(faultLabel);
            
            for (let i = 0; i < steps.length; i++) {
                const td = document.createElement('td');
                td.textContent = steps[i].fault ? 'F' : 'H';
                td.className = steps[i].fault ? 'fault-cell' : 'hit-cell';
                faultRow.appendChild(td);
            }
            
            tbody.appendChild(faultRow);
            table.appendChild(tbody);
            container.appendChild(table);

            const note = document.createElement('div');
            note.className = 'note';
            note.innerHTML = `<strong>–¢–∞–π–ª–±–∞—Ä:</strong> F = Page Fault (–∞–ª–¥–∞–≥–¥–∞–ª), H = Hit (—Å–∞–Ω–∞—Ö –æ–π–¥ –±–∞–π–≥–∞–∞)`;
            container.appendChild(note);
        }

        document.getElementById('runBtn').addEventListener('click', () => {
            const refStr = document.getElementById('refInput').value;
            const framesCount = parseInt(document.getElementById('framesInput').value, 10) || 3;
            const ref = parseRef(refStr);
            
            if (ref.length === 0) {
                alert('Reference string —Ö–æ–æ—Å–æ–Ω –±–∞–π–Ω–∞!');
                return;
            }

            const fifo = simulateFIFO(ref, framesCount);
            const lru = simulateLRU(ref, framesCount);
            const opt = simulateOptimal(ref, framesCount);

            renderTable(document.getElementById('fifoCard'), 'FIFO - First In First Out', fifo);
            renderTable(document.getElementById('lruCard'), 'LRU - Least Recently Used', lru);
            renderTable(document.getElementById('optCard'), 'Optimal - –û–Ω–æ–≤—á—Ç–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º', opt);
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            document.getElementById('refInput').value = '7,0,1,2,0,3,0,4,2,3,0,3,2,1,2,0,1,7,0,1';
            document.getElementById('framesInput').value = 3;
            document.getElementById('runBtn').click();
        });

        window.onload = () => {
            document.getElementById('runBtn').click();
        };
    </script>
</body>
</html>